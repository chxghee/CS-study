# 8.6 함수 기반 인덱스
일반적으로 컬럼의 값을 연산자나 함수로 변경하면 B-Tree인덱스를 사용할 수 없었다.

하지만 `함수 기반 인덱스`를 통해 변경된 컬럼값을 인덱싱 할 수 있다.

구현방법에는 다음의 두가지가 있다.
1. 가상 컬럼을 이용한 인덱스
2. 함수를 이용한 인덱스

인덱싱 할 값을 계산하는 과정만 차이가 있고 내부 구조는 B-Tree인덱스와 동일하다.

<br>

## 방법1. 가상 컬럼을 이용한 인덱스

- 만약 first_name, last_name을 합쳐서 검색해야 하는 상황이 필요하다...
- 가상 컬럼인 `full_name`을 만들어 인덱스를 생성할 수 있다.

이전에는 `full_name`컬럼을 추가하고 모든 레코드에 대해 full_name을 업데이트 하는 과정이 필요했지만,   
간편하게 가상 컬럼을 추가할수 있게 되었다.

```sql
alter table user
  add full_name VARCHAR(30) as (concat(first_name, ' ', last_name)) virtual,
  add index 인덱스명 (full_name)
```
하지만 가상 컬럼 인덱스 또한 컬럼을 추가하는 것과 같이 테이블의 구조를 변경한다는 단점이 있다.


<br>

## 방법2. 함수를 이용한 인덱스
테이블 구조의 변경없이 함수를 직접 사용하는 인덱스를 생성한다.

```sql
create index 인덱스 명 ((concat(first_name, ' ', last_name))
```
이렇게 인덱스를 추가하게 되면 계산된 결과값을 빠르게 조회할 수 있다.

이때 중요한 점은 조건절의 함수 표현이 위의 인덱스를 생성할 때 사용한 표현과 일치해야 한다.


