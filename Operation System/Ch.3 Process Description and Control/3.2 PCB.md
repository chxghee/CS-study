## OS 제어 테이블
> OS는 프로세스와 자원 관리를 위해 여러 테이블을 만들어 현재 상태 정보를 저장합니다.

이 테이블에는 4가지 종류가 있습니다.




### 1. 메모리 테이블
> 메인 메모리와 보조기억장치(하드디스크 Swapping Area or 가상 메모리)의 상태를 유지합니다.

- 즉 메모리의 몇 번지가 어떤 프로세스에 할당이 되어 있는지를 저장합니다.
- 보조기억장치의 몇 번지가 어떤 프로세스에 할당이 되어 있는지를 저장합니다.
- 여러 프로세스들이 공유할수 있는 공유 메모리에 접근이 가능한 프로세스의 정보를 저장합니다.
- 가상 메모리를 관리위한(어떤 프로세스의 무슨 블럭이 어느 위치에 있는지) 정보를 저장합니다.



### 2. I/O 테이블
> 시스템 내에 존재하는 모든 I/O 장치들과 해당 장치들이 현재  사용중인지에 관한 상태 정보를 유지합니다.

- I/O 장치가 사용중인지 사용가능한지
- I/O 연산의 상태

데이터 출력: Memory → I/O buffer → I/O module
데이터 입력: I/O module → I/O buffer → Memory
과 같은 흐름을 갖는데 위에서 현재 데이터가 어디에 위치 하는 지 상태를 저장합니다. 

### 3. 파일 테이블
> 보조기억장치(디스크) 상의 파일 및 디렉터리 정보를 관리합니다.

- 파일 이름, 파일 위치(디스크 블록 주소)
- 파일 크기, 접근 권한, 소유자, 생성·수정 시각 등 속성 정보 (Metadata)
- 열린 파일 목록 (열린 파일 테이블: per-process / system-wide 두 종류 존재)
- 실행 파일의 위치나 로딩 상태 정보

“파일 시스템의 메타데이터 + 열린 파일 상태”를 관리합니다.

### 4. 프로세스 테이블
> 프로세스 관리에 필요한 상태 정보들을 유지합니다.

- 프로세스 Id
- 프로세스 현재 상태
- 프로세스 이미지 (프로세스 상태 정보를 담은 이미지)에 대한 포인터
- 프로세스가 메모리에 저장된 위치 정보를 저장합니다.

PCB(Process Control Block) 들이 모인 구조로, 프로세스 관리의 핵심입니다.

![](https://velog.velcdn.com/images/chxghee/post/985064fe-506e-4fb9-b6eb-56694058d244/image.png)

이 네가지 테이블들은 모두 메인 매모리 내의 커널 영역에 존재합니다.
OS는 해당 테이블 들을 통해 시스템의 현재 상태를 알아내고 적절하게 제어하는 역할을 합니다.



---
<br>
<br>

## 프로세스 이미지
> 프로세스 이미지는 운영체제가 프로세스를 관리하기 위해 보관하는 프로세스 전체의 상태 정보 집합입니다

모든 프로세스의 전체가 한 번에 메모리에 적재될 수 없기 때문에, 운영체제는 프로세스 이미지(Process Image) 라는 것을 통해
각 프로세스의 전체 구조(코드, 데이터, 스택, PCB 등)를 논리적으로 관리합니다.

OS는 프로세스 실행 시에 프로세스 이미지 전체가 아닌, 필요한 부분(코드 블록이나 페이지 등) 만 메인 메모리에 올려 사용합니다.

따라서 OS는 프로세스 이미지에 기록된 정보를 기반으로 현재 메모리에 어떤 블록이 올라와 있고,
어떤 블록을 추가로 적재하거나 내보낼지를 관리할 수 있습니다.

프로세스 이미지의 구성요소는 다음과 같습니다.

### 1. 유저 데이터
> 프로그램 데이터 라고도 하며, 프로그램이 실행 되면서 전역 변수 와 같은 부분입니다.

- 프로그램에서 사용하는 전역 변수, static 변수 등이 저장됩니다.
- 실행 도중 값이 변경될 수 있는 수정 가능한(Read-Write) 데이터입니다.

### 2. 유저 프로그램
> 프로그램 코드라고도 하며, 수행될 프로그램을 의미합니다.



- 실제로 CPU가 실행할 명령어들이 저장된 부분입니다.
- 컴파일된 실행 코드(기계어 형태)로 구성됩니다.
- 읽기 전용 (Read-Only) 으로, 실행 중 수정되지 않습니다.
- 예: main() 함수, if문, 반복문, 연산 명령어 등

`유저 데이터`와 `유저 프로그램`은 실행 파일에 들어있는 데이터 입니다.

### 3. stack
> 프로그램 실행 중. 지역 변수들을 저장할 메모리 공간을 의미합니다.

각 프로세스는 하나 이상의 스택을 갖고,
함수 호출 시 생성되는 지역 변수, 매개변수, 복귀 주소 등을 저장합니다.

### 4. PCB
> 운영체제가 프로세스를 식별하고 제어하기 위해 관리하는 데이터를 의미합니다.

- 프로세스의 상태(State)
- 프로그램 카운터(PC), 레지스터 값
- 프로세스 ID (PID), 우선순위, 스케줄링 정보
- 메모리 관리 정보 (페이지 테이블 포인터 등)
- 파일, I/O 상태 정보

등의 정보를 갖습니다.

PCB는 유저 프로세스는 접근이 불가하고, 운영체제 만 읽고 쓰기가 가능합니다.

<br>
<br>

## PCB (Process Control Block)

PCB에 저장되는 상태 정보들은 다음과 같습니다.

### 1. 프로세스 식별자
- 프로세스(나)의 식별자
- 부모 프로세스의 식별자
- 유저 식별자 

### 2. 프로세서 상태 정보
- 프로그램 실행 중 중단이 되면, 현재 프로세세의 레지스터의 내용이 `컨트롤 스택`에 저장합니다. 
(프로세스는 수행 중일 떄:는 레지스터에 존재하지만, 인터럽트로 인해 중단되면, 나중에 다시 이어서 실행 해야 하기 떄문에 저장)
- 컨트롤 상태 레지스터: PC, PSW


### 3. 프로세스 제어 정보
> 운영체제가 활성화된 프로세스를 제어하고 실행에 필요한 모든 추가 정보들을 저장합니다.

- 프로세스 상태 (레디, 블락...)
- 현재 프로세스 위치 (메모리or하드디스크?)
- 프로세스 권한
- 프로세스 구조화 정보


![](https://velog.velcdn.com/images/chxghee/post/e364ec30-32b4-4ff2-b278-4d8f6e27f8f1/image.png)

---

<br>
<br>

## OS 커널의 주요 기능
### 1. 프로세스 관리
- 프로세스 생성/종료 (자원 반납)
- CPU가 실행할 프로세스 스케줄링
- 스위칭 작업 
- 프로세스 동기화 
- PCB관리


### 2. 메모리 관리
- 프로세스 주소 공간 할당 (메인 메모리 or 하드디스크 스와핑 에어리어)
- 스와핑 (어떤 프로세스를 하드로 내릴 지)
- 페이지와 세그먼트 관리 (여러 블록으로 나뉜 프로세스들을 어떻게 찾을 지)


### 3. 입출력 관리
- 버퍼 관리 (프로세스 데이터 버퍼에 저장 후 출력)
- 프로세스에 입출력 장치 및 채널 할당

### 4. 지원 기능
- 인터럽트 핸들링
- 어카운팅
- 모니터링

